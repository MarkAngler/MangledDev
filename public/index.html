<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MangledDev - Claude Terminal Manager</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@4.19.0/css/xterm.css">
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div id="app">
    <aside id="sidebar">
      <div id="header">
        <h1>MangledDev</h1>
        <div id="view-tabs">
          <button class="view-tab active" data-view="sessions">Sessions</button>
          <button class="view-tab" data-view="evaluations">Evaluations</button>
          <button class="view-tab" data-view="extensions">Extensions</button>
          <button class="view-tab" data-view="config">Config</button>
          <button class="view-tab" data-view="large-files">Large Files</button>
        </div>
        <button id="new-session-btn">+ New Session</button>
      </div>
      <div id="session-list"></div>
      <div id="task-panel">
        <div id="task-header">
          <button id="task-toggle-btn"><span id="task-toggle-icon">&#9662;</span> Tasks</button>
          <button id="new-task-btn" title="Add Task">+</button>
        </div>
        <div id="task-list"></div>
      </div>
    </aside>
    <main id="terminal-area">
      <div id="terminal-header">
        <span id="current-session-name">Select a session</span>
        <div id="session-controls" style="display: none;">
          <button id="restart-btn" title="Restart">Restart</button>
          <button id="stop-btn" title="Stop">Stop</button>
        </div>
        <button id="workflow-toggle-btn" title="Toggle Workflows">Workflows</button>
      </div>
      <div id="terminal-container"></div>
    </main>
    <main id="evaluations-area" style="display: none;">
      <div id="evaluations-header">
        <h2>Prompt Evaluations</h2>
        <div id="evaluations-controls">
          <button id="new-evaluation-btn">+ New Evaluation</button>
          <button id="new-comparison-btn">+ A/B Compare</button>
        </div>
      </div>
      <div id="evaluations-content">
        <div id="evaluations-tabs">
          <button class="eval-tab active" data-eval-view="list">Evaluations</button>
          <button class="eval-tab" data-eval-view="comparisons">Comparisons</button>
        </div>
        <div id="evaluations-list"></div>
        <div id="comparisons-list" style="display: none;"></div>
        <div id="evaluation-detail" style="display: none;">
          <button id="back-to-list-btn">&larr; Back</button>
          <div id="evaluation-detail-content"></div>
        </div>
      </div>
    </main>
    <main id="extensions-area" style="display: none;">
      <div id="extensions-header">
        <h2>Claude Code Extensions</h2>
        <button id="refresh-extensions-btn">Refresh</button>
      </div>
      <div id="extensions-content">
        <div id="extensions-loading">Loading extensions...</div>
        <div id="extensions-grid"></div>
      </div>
    </main>
    <main id="config-area" style="display: none;">
      <div id="config-header">
        <span id="config-file-name">Select a file</span>
        <div id="config-controls" style="display: none;">
          <button id="save-config-btn">Save</button>
          <button id="discard-config-btn">Discard</button>
        </div>
      </div>
      <div id="config-content">
        <div id="config-file-list"></div>
        <div id="config-editor-container">
          <textarea id="config-editor" placeholder="Select a file to edit..."></textarea>
        </div>
      </div>
    </main>
    <main id="large-files-area" style="display: none;">
      <div id="large-files-header">
        <h2>Large Files</h2>
        <div id="large-files-controls">
          <label>
            Threshold:
            <input type="number" id="threshold-input" value="500" min="1">
            lines
          </label>
          <button id="scan-large-files-btn">Scan</button>
        </div>
      </div>
      <div id="large-files-content">
        <div id="large-files-results"></div>
      </div>
    </main>
    <aside id="workflow-panel" style="display: none;">
      <div id="workflow-header">
        <span>Workflows</span>
        <button id="new-workflow-btn" title="New Workflow">+</button>
      </div>
      <div id="workflow-list"></div>
    </aside>
  </div>

  <dialog id="new-session-dialog">
    <form method="dialog">
      <h2>New Claude Session</h2>
      <label>
        Name (optional):
        <input type="text" id="session-name-input" placeholder="claude-1">
      </label>
      <label class="checkbox-label">
        <input type="checkbox" id="skip-permissions-input">
        Skip permissions (--dangerously-skip-permissions)
      </label>
      <div id="dialog-buttons">
        <button type="button" id="cancel-dialog-btn">Cancel</button>
        <button type="submit" id="create-session-btn">Create</button>
      </div>
    </form>
  </dialog>

  <dialog id="task-dialog">
    <form method="dialog">
      <h2 id="task-dialog-title">New Task</h2>
      <label>
        Title:
        <input type="text" id="task-title-input" required>
      </label>
      <label>
        Priority:
        <select id="task-priority-input">
          <option value="low">Low</option>
          <option value="medium" selected>Medium</option>
          <option value="high">High</option>
        </select>
      </label>
      <label>
        Due Date (optional):
        <input type="date" id="task-due-input">
      </label>
      <div id="dialog-buttons">
        <button type="button" id="cancel-task-btn">Cancel</button>
        <button type="submit" id="save-task-btn">Save</button>
      </div>
    </form>
  </dialog>

  <dialog id="workflow-dialog">
    <form method="dialog">
      <h2 id="workflow-dialog-title">New Workflow</h2>
      <label>
        Name:
        <input type="text" id="workflow-name-input" required>
      </label>
      <div id="workflow-steps-container">
        <div id="workflow-steps-header">
          <span>Steps</span>
          <button type="button" id="add-step-btn">+ Add Step</button>
        </div>
        <div id="workflow-steps-list"></div>
      </div>
      <div id="dialog-buttons">
        <button type="button" id="cancel-workflow-btn">Cancel</button>
        <button type="submit" id="save-workflow-btn">Save</button>
      </div>
    </form>
  </dialog>

  <dialog id="evaluation-dialog">
    <form method="dialog">
      <h2>New Evaluation</h2>
      <label>
        Name:
        <input type="text" id="eval-name-input" required placeholder="My evaluation">
      </label>
      <label>
        Behavior to test:
        <select id="eval-behavior-input"></select>
      </label>
      <label>
        System Prompt (optional):
        <textarea id="eval-prompt-input" rows="4" placeholder="Custom system prompt for the agent being evaluated..."></textarea>
      </label>
      <label>
        Tier:
        <select id="eval-tier-input">
          <option value="quick">Quick (5 scenarios, ~2 min)</option>
          <option value="standard" selected>Standard (20 scenarios, ~10 min)</option>
          <option value="comprehensive">Comprehensive (50 scenarios, ~30 min)</option>
        </select>
      </label>
      <div id="dialog-buttons">
        <button type="button" id="cancel-eval-btn">Cancel</button>
        <button type="submit" id="create-eval-btn">Create</button>
      </div>
    </form>
  </dialog>

  <dialog id="comparison-dialog">
    <form method="dialog">
      <h2>A/B Prompt Comparison</h2>
      <label>
        Name:
        <input type="text" id="comp-name-input" required placeholder="Prompt A vs B">
      </label>
      <label>
        Behavior to test:
        <select id="comp-behavior-input"></select>
      </label>
      <label>
        Prompt A:
        <textarea id="comp-prompt-a-input" rows="3" required placeholder="System prompt for variant A..."></textarea>
      </label>
      <label>
        Prompt B:
        <textarea id="comp-prompt-b-input" rows="3" required placeholder="System prompt for variant B..."></textarea>
      </label>
      <label>
        Tier:
        <select id="comp-tier-input">
          <option value="quick">Quick (5 scenarios)</option>
          <option value="standard" selected>Standard (20 scenarios)</option>
          <option value="comprehensive">Comprehensive (50 scenarios)</option>
        </select>
      </label>
      <div id="dialog-buttons">
        <button type="button" id="cancel-comp-btn">Cancel</button>
        <button type="submit" id="create-comp-btn">Create & Run</button>
      </div>
    </form>
  </dialog>

  <script src="https://cdn.jsdelivr.net/npm/xterm@4.19.0/lib/xterm.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.5.0/lib/xterm-addon-fit.js"></script>
  <script src="/client.js"></script>
</body>
</html>
